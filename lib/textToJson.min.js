!function(t,u){"function"==typeof define&&define.amd?define([],u):"object"==typeof exports?module.exports=u():t.TextToJson=u()}(this,function(){"use strict";function t(t){return"object"==typeof t}function u(t){return Array.isArray(t)}function e(t){var u=/\*\*([\S\s]+?)\*\*/g,e="**",n="b|",r=t.replace(u,e+n+"$1"+e).split(e),o=[];return r.map(function(t,u){return""!==t?t.substr(0,2)===n?(t=t.substr(2),void o.push({tag:"b",value:t})):void o.push(t):void 0}),o}function n(t){var u=/\*([\S\s]+?)\*/g,e="*",n="i|",r=t.replace(u,e+n+"$1"+e).split(e),o=[];return r.map(function(t,u){return""!==t?t.substr(0,2)===n?(t=t.substr(2),void o.push({tag:"i",value:t})):void o.push(t):void 0}),1===o.length&&(o=o[0]),o}function r(r){var o=e(r),i=[];return u(o)&&o.map(function(e,r){if(t(e))return void i.push(e);var o=n(e);if(u(o))for(var r=0;r<o.length;r++)i.push(o[r]);else i.push(o)}),1===i.length&&(i=i[0]),i}function o(e){var n=e.split("\n"),o=[];return n.map(function(u,e){var n=o[o.length-1];return""===u?void(t(n)&&"br"===n.tag||o.push({tag:"br"})):"..."===u?void o.push({tag:"hr"}):">"===u[0]?(u=r(u.substr(1)),void(t(n)&&"blockquote"===n.tag?n.value.push(u):o.push({tag:"blockquote",value:[u]}))):(u=r(u),void o.push(u))}),o.map(function(e,n){t(e)&&"blockquote"===e.tag&&u(e.value)&&(1===e.value.length?(e.value=e.value[0],o[n]=e):e.value.map(function(t,n){u(t)&&1===t.length&&(e.value[n]=t[0])}))}),o}return o});